"use strict";(self.webpackChunkMailPoet3=self.webpackChunkMailPoet3||[]).push([[392],{57647:function(e,t,n){var o={};n.r(o),n.d(o,{__experimentalGetDefaultTemplatePartAreas:function(){return lo},__experimentalGetDefaultTemplateType:function(){return co},__experimentalGetDefaultTemplateTypes:function(){return ao},__experimentalGetTemplateInfo:function(){return uo},__unstableIsEditorReady:function(){return rn},canInsertBlockType:function(){return oo},canUserUseUnfilteredHTML:function(){return Yt},didPostSaveRequestFail:function(){return Dt},didPostSaveRequestSucceed:function(){return At},getActivePostLock:function(){return Qt},getAdjacentBlockClientId:function(){return Tn},getAutosaveAttribute:function(){return yt},getBlock:function(){return mn},getBlockAttributes:function(){return pn},getBlockCount:function(){return bn},getBlockHierarchyRootClientId:function(){return Pn},getBlockIndex:function(){return Fn},getBlockInsertionPoint:function(){return Yn},getBlockListSettings:function(){return so},getBlockMode:function(){return qn},getBlockName:function(){return un},getBlockOrder:function(){return Vn},getBlockRootClientId:function(){return Nn},getBlockSelectionEnd:function(){return yn},getBlockSelectionStart:function(){return kn},getBlocks:function(){return gn},getBlocksByClientId:function(){return _n},getClientIdsOfDescendants:function(){return hn},getClientIdsWithDescendants:function(){return fn},getCurrentPost:function(){return mt},getCurrentPostAttribute:function(){return bt},getCurrentPostId:function(){return ht},getCurrentPostLastRevisionId:function(){return vt},getCurrentPostRevisionsCount:function(){return ft},getCurrentPostType:function(){return gt},getEditedPostAttribute:function(){return kt},getEditedPostContent:function(){return Ut},getEditedPostPreviewLink:function(){return Ot},getEditedPostSlug:function(){return Wt},getEditedPostVisibility:function(){return wt},getEditorBlocks:function(){return en},getEditorSelection:function(){return on},getEditorSelectionEnd:function(){return nn},getEditorSelectionStart:function(){return tn},getEditorSettings:function(){return sn},getFirstMultiSelectedBlockClientId:function(){return An},getGlobalBlockCount:function(){return vn},getInserterItems:function(){return io},getLastMultiSelectedBlockClientId:function(){return Dn},getMultiSelectedBlockClientIds:function(){return Bn},getMultiSelectedBlocks:function(){return Zn},getMultiSelectedBlocksEndClientId:function(){return Un},getMultiSelectedBlocksStartClientId:function(){return Rn},getNextBlockClientId:function(){return Cn},getPermalink:function(){return Ht},getPermalinkParts:function(){return Kt},getPostEdits:function(){return _t},getPostLockUser:function(){return Jt},getPostTypeLabel:function(){return po},getPreviousBlockClientId:function(){return En},getSelectedBlock:function(){return jn},getSelectedBlockClientId:function(){return Sn},getSelectedBlockCount:function(){return wn},getSelectedBlocksInitialCaretPosition:function(){return In},getStateBeforeOptimisticTransaction:function(){return an},getSuggestedPostFormat:function(){return Rt},getTemplate:function(){return to},getTemplateLock:function(){return no},hasChangedContent:function(){return ct},hasEditorRedo:function(){return at},hasEditorUndo:function(){return st},hasInserterItems:function(){return ro},hasMultiSelection:function(){return zn},hasNonPostEntityChanges:function(){return dt},hasSelectedBlock:function(){return xn},hasSelectedInnerBlock:function(){return Wn},inSomeHistory:function(){return ln},isAncestorMultiSelected:function(){return On},isAutosavingPost:function(){return Mt},isBlockInsertionPointVisible:function(){return Xn},isBlockMultiSelected:function(){return Ln},isBlockSelected:function(){return Hn},isBlockValid:function(){return dn},isBlockWithinSelection:function(){return Kn},isCaretWithinFormattedText:function(){return Qn},isCleanNewPost:function(){return pt},isCurrentPostPending:function(){return xt},isCurrentPostPublished:function(){return St},isCurrentPostScheduled:function(){return jt},isEditedPostAutosaveable:function(){return Et},isEditedPostBeingScheduled:function(){return Ct},isEditedPostDateFloating:function(){return It},isEditedPostDirty:function(){return ut},isEditedPostEmpty:function(){return Tt},isEditedPostNew:function(){return lt},isEditedPostPublishable:function(){return Nt},isEditedPostSaveable:function(){return Pt},isFirstMultiSelectedBlock:function(){return Mn},isMultiSelecting:function(){return Gn},isPermalinkEditable:function(){return Ft},isPostAutosavingLocked:function(){return $t},isPostLockTakeover:function(){return qt},isPostLocked:function(){return zt},isPostSavingLocked:function(){return Gt},isPreviewingPost:function(){return Lt},isPublishSidebarEnabled:function(){return Xt},isPublishingPost:function(){return Vt},isSavingNonPostEntityChanges:function(){return Zt},isSavingPost:function(){return Bt},isSelectionEnabled:function(){return $n},isTyping:function(){return Jn},isValidTemplate:function(){return eo}});var i={};n.r(i),n.d(i,{__experimentalTearDownEditor:function(){return vo},autosave:function(){return jo},clearSelectedBlock:function(){return Go},createUndoLevel:function(){return To},disablePublishSidebar:function(){return Io},editPost:function(){return yo},enablePublishSidebar:function(){return Co},enterFormattedText:function(){return pi},exitFormattedText:function(){return mi},hideInsertionPoint:function(){return oi},insertBlock:function(){return ei},insertBlocks:function(){return ti},insertDefaultBlock:function(){return gi},lockPostAutosaving:function(){return Ao},lockPostSaving:function(){return Bo},mergeBlocks:function(){return si},moveBlockToPosition:function(){return Xo},moveBlocksDown:function(){return Qo},moveBlocksUp:function(){return Yo},multiSelect:function(){return zo},receiveBlocks:function(){return Uo},redo:function(){return No},refreshPost:function(){return xo},removeBlock:function(){return li},removeBlocks:function(){return ai},replaceBlock:function(){return Jo},replaceBlocks:function(){return qo},resetBlocks:function(){return Ro},resetEditorBlocks:function(){return Mo},resetPost:function(){return _o},savePost:function(){return wo},selectBlock:function(){return Ho},setTemplateValidity:function(){return ii},setupEditor:function(){return fo},setupEditorState:function(){return ko},showInsertionPoint:function(){return ni},startMultiSelect:function(){return Wo},startTyping:function(){return ui},stopMultiSelect:function(){return Ko},stopTyping:function(){return di},synchronizeTemplate:function(){return ri},toggleBlockMode:function(){return ci},toggleSelection:function(){return $o},trashPost:function(){return So},undo:function(){return Po},unlockPostAutosaving:function(){return Do},unlockPostSaving:function(){return Zo},updateBlock:function(){return Vo},updateBlockAttributes:function(){return Fo},updateBlockListSettings:function(){return hi},updateEditorSettings:function(){return Lo},updatePost:function(){return bo},updatePostLock:function(){return Eo}});var r=n(65443),s=n.n(r),a=n(64151),l=n(33851),c=n(52278),u=n(3610),d=n(90057),p=n(87834),m=n(49231),g=n(33140),h=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,m.createElement)(g.y$,{d:"M20 10c0-5.51-4.49-10-10-10C4.48 0 0 4.49 0 10c0 5.52 4.48 10 10 10 5.51 0 10-4.48 10-10zM7.78 15.37L4.37 6.22c.55-.02 1.17-.08 1.17-.08.5-.06.44-1.13-.06-1.11 0 0-1.45.11-2.37.11-.18 0-.37 0-.58-.01C4.12 2.69 6.87 1.11 10 1.11c2.33 0 4.45.87 6.05 2.34-.68-.11-1.65.39-1.65 1.58 0 .74.45 1.36.9 2.1.35.61.55 1.36.55 2.46 0 1.49-1.4 5-1.4 5l-3.03-8.37c.54-.02.82-.17.82-.17.5-.05.44-1.25-.06-1.22 0 0-1.44.12-2.38.12-.87 0-2.33-.12-2.33-.12-.5-.03-.56 1.2-.06 1.22l.92.08 1.26 3.41zM17.41 10c.24-.64.74-1.87.43-4.25.7 1.29 1.05 2.71 1.05 4.25 0 3.29-1.73 6.24-4.4 7.78.97-2.59 1.94-5.2 2.92-7.78zM6.1 18.09C3.12 16.65 1.11 13.53 1.11 10c0-1.3.23-2.48.72-3.59C3.25 10.3 4.67 14.2 6.1 18.09zm4.03-6.63l2.58 6.98c-.86.29-1.76.45-2.71.45-.79 0-1.57-.11-2.29-.33.81-2.38 1.62-4.74 2.42-7.1z"})),f=n(98005),v=n(353),_=n(95393),b=n(67911),k=n(54600),y=n(85479),w=n(30337),x=n(17921),S=n(14676),j=n(34380),N=n(82435),P=n(76767),T=n(41325),E=n(20264);const C=x.Z;function I(e){let{children:t}=e;const{workflowName:n,workflowStatus:o,showIconLabels:i}=(0,p.Z)((e=>({workflowName:e(P.storeName).getWorkflowData().name,workflowStatus:e(P.storeName).getWorkflowData().status,showIconLabels:e(P.storeName).isFeatureActive("showIconLabels")})),[]),r=(0,m.useRef)();let s="mailpoet-automation-editor-chip-gray";return o===T.x.ACTIVE?s="mailpoet-automation-editor-chip-success":o===T.x.INACTIVE&&(s="mailpoet-automation-editor-chip-danger"),(0,E.jsx)("div",{className:"edit-site-document-actions has-secondary-label",children:(0,E.jsx)("div",{ref:r,className:"edit-site-document-actions__title-wrapper",children:t&&(0,E.jsx)(C,{popoverProps:{anchorRef:r.current},position:"bottom center",renderToggle:e=>{let{isOpen:t,onToggle:r}=e;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("a",{className:"mailpoet-automation-editor-dropdown-toggle-link",href:"#",onClick:r,children:[(0,E.jsxs)(S.Z,{size:"body",className:"edit-site-document-actions__title",as:"h1",children:[(0,E.jsx)(j.Z,{as:"span",children:(0,w.__)("Editing workflow: ")}),n]}),(0,E.jsxs)(S.Z,{size:"body",className:`edit-site-document-actions__secondary-item ${s}`,children:[o===T.x.ACTIVE&&(0,w.__)("Active"),o===T.x.INACTIVE&&(0,w.__)("Inactive"),o===T.x.DRAFT&&(0,w.__)("Draft")]})]}),(0,E.jsx)(c.Z,{className:"edit-site-document-actions__get-info",icon:N.Z,"aria-expanded":t,"aria-haspopup":"true",onClick:r,label:(0,w.__)("Change workflow name"),children:i&&(0,w.__)("Rename")})]})},contentClassName:"edit-site-document-actions__info-dropdown",renderContent:t})})})}var B=n(9487),Z=n(96097);function A(){const{isInserterOpened:e,showIconLabels:t}=(0,p.Z)((e=>({isInserterOpened:e(P.storeName).isInserterSidebarOpened(),showIconLabels:e(P.storeName).isFeatureActive("showIconLabels")})),[]),{toggleInserterSidebar:n}=(0,y.Z)(P.storeName);return(0,E.jsx)(B.Z,{as:c.Z,className:"edit-site-header-toolbar__inserter-toggle",variant:"primary",isPressed:e,onMouseDown:e=>e.preventDefault(),onClick:n,icon:Z.Z,label:(0,w._x)("Toggle step inserter","Generic label for step inserter button"),showTooltip:!t,children:t&&(e?(0,w.__)("Close"):(0,w.__)("Add"))})}var D=n(53703),M=n(83830),L=n(73435),O=n(62271),R=n(45538),U=n(21602);function V(e){let{scope:t,name:n,label:o,info:i,messageActivated:r,messageDeactivated:s,shortcut:a}=e;const l=(0,p.Z)((e=>!!e(U.h).get(t,n)),[n]),{toggle:c}=(0,y.Z)(U.h);return(0,m.createElement)(L.Z,{icon:l&&O.Z,isSelected:l,onClick:()=>{c(t,n),(()=>{if(l){const e=s||(0,w.sprintf)((0,w.__)("Preference deactivated - %s"),o);(0,R.D)(e)}else{const e=r||(0,w.sprintf)((0,w.__)("Preference activated - %s"),o);(0,R.D)(e)}})()},role:"menuitemcheckbox",info:i,shortcut:a},o)}function F(){return(0,E.jsx)(f.Eo,{className:"edit-site-more-menu",popoverProps:{className:"edit-site-more-menu__content"},children:()=>(0,E.jsx)(D.Z,{label:(0,w._x)("View","noun"),children:(0,E.jsx)(V,{scope:P.storeName,name:"fullscreenMode",label:(0,w.__)("Fullscreen mode"),info:(0,w.__)("Work without distraction"),messageActivated:(0,w.__)("Fullscreen mode activated"),messageDeactivated:(0,w.__)("Fullscreen mode deactivated"),shortcut:M.displayShortcut.secondary("f")})})})}function H(){const{activate:e}=(0,y.Z)(P.storeName);return(0,E.jsx)(c.Z,{isPrimary:!0,className:"editor-post-publish-button",onClick:e,children:"Activate"})}function W(){const{activate:e}=(0,y.Z)(P.storeName);return(0,E.jsx)(c.Z,{isPrimary:!0,className:"editor-post-publish-button",onClick:e,children:"Update"})}function K(){const{save:e}=(0,y.Z)(P.storeName);return(0,E.jsx)(c.Z,{isTertiary:!0,onClick:e,children:(0,w.__)("Save Draft")})}function z(e){let{showInserterToggle:t}=e;const{setWorkflowName:n}=(0,y.Z)(P.storeName),{workflowName:o,workflowStatus:i}=(0,p.Z)((e=>({workflowName:e(P.storeName).getWorkflowData().name,workflowStatus:e(P.storeName).getWorkflowData().status})),[]);return(0,E.jsxs)("div",{className:"edit-site-header",children:[(0,E.jsx)("div",{className:"edit-site-header_start",children:(0,E.jsx)(b.Z,{className:"edit-site-header__toolbar",orientation:"horizontal",role:"toolbar",children:t&&(0,E.jsx)(A,{})})}),(0,E.jsx)("div",{className:"edit-site-header_center",children:(0,E.jsx)(I,{children:()=>(0,E.jsxs)("div",{className:"mailpoet-automation-editor-dropdown-name-edit",children:[(0,E.jsx)("div",{className:"mailpoet-automation-editor-dropdown-name-edit-title",children:(0,w.__)("Automation name")}),(0,E.jsx)(k.Z,{value:o,onChange:e=>n(e),help:(0,w.__)('Give the automation a name that indicates its purpose. E.g. "Abandoned cart recovery"')})]})})}),(0,E.jsx)("div",{className:"edit-site-header_end",children:(0,E.jsxs)("div",{className:"edit-site-header__actions",children:[(0,E.jsx)(K,{}),i!==T.x.ACTIVE&&(0,E.jsx)(H,{}),i===T.x.ACTIVE&&(0,E.jsx)(W,{}),(0,E.jsx)(f.Ox.Slot,{scope:P.storeName}),(0,E.jsx)(F,{})]})})]})}var G=n(2637),$=n(47842),q=n(1779);function J(e){let{icon:t}=e;return(0,E.jsx)("span",{className:"block-editor-block-icon",children:(0,E.jsx)(u.Z,{icon:t})})}function Q(e){let{item:t}=e;const{title:n,icon:o,description:i}=t;return(0,E.jsx)("div",{className:"block-editor-inserter__preview-container",children:(0,E.jsxs)("div",{className:"block-editor-block-card",children:[(0,E.jsx)(J,{icon:o}),(0,E.jsxs)("div",{className:"block-editor-block-card__content",children:[(0,E.jsx)("h2",{className:"block-editor-block-card__title",children:n}),(0,E.jsx)("span",{className:"block-editor-block-card__description",children:i})]})]})})}var Y=n(88565);const X=(0,m.createContext)(void 0),ee=(0,m.forwardRef)(((e,t)=>{let{isFirst:n,children:o,...i}=e;const r=(0,m.useContext)(X);return(0,E.jsx)(Y.A,{ref:t,state:r,role:"option",focusable:!0,...i,children:e=>{const t={...e,tabIndex:n?0:e.tabIndex};return(0,E.jsx)(c.Z,{...t,children:o})}})})),te=()=>{const{platform:e}=window.navigator;return-1!==e.indexOf("Mac")||["iPad","iPhone"].includes(e)},ne=(0,m.memo)((e=>{let{className:t,isFirst:n,item:o,onSelect:i,onHover:r,isDraggable:a,...l}=e;const c=(0,m.useRef)(!1);return(0,E.jsx)("div",{className:"block-editor-block-types-list__list-item",children:(0,E.jsxs)(ee,{isFirst:n,className:s()("block-editor-block-types-list__item",t),disabled:o.isDisabled,onClick:e=>{e.preventDefault(),i(o,te()?e.metaKey:e.ctrlKey),r(null)},onKeyDown:e=>{const{keyCode:t}=e;t===M.ENTER&&(e.preventDefault(),i(o,te()?e.metaKey:e.ctrlKey),r(null))},onFocus:()=>{c.current||r(o)},onMouseEnter:()=>{c.current||r(o)},onMouseLeave:()=>r(null),onBlur:()=>r(null),...l,children:[(0,E.jsx)("span",{className:"block-editor-block-types-list__item-icon",children:(0,E.jsx)(J,{icon:o.icon})}),(0,E.jsx)("span",{className:"block-editor-block-types-list__item-title",children:o.title})]})})})),oe=(0,m.forwardRef)(((e,t)=>{const[n,o]=(0,m.useState)(!1);return(0,m.useEffect)((()=>{n&&(0,R.D)((0,w.__)("Use left and right arrow keys to move through blocks"))}),[n]),(0,E.jsx)("div",{ref:t,role:"listbox","aria-orientation":"horizontal",onFocus:()=>{o(!0)},onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&o(!1)},...e})}));var ie=n(17750);const re=(0,m.forwardRef)(((e,t)=>{const n=(0,m.useContext)(X);return(0,E.jsx)(ie.E,{state:n,role:"presentation",ref:t,...e})})),se=(e,t)=>{const n=[];for(let o=0,i=e.length;o<i;o+=t)n.push(e.slice(o,o+t));return n};function ae(e){let{items:t,onSelect:n,onHover:o,label:i,isDraggable:r=!0,children:s}=e;return(0,E.jsxs)(oe,{className:"block-editor-block-types-list","aria-label":i,children:[se(t,3).map(((e,t)=>(0,E.jsx)(re,{children:e.map(((e,i)=>{return(0,E.jsx)(ne,{item:e,className:(s=e.key,`editor-block-list-item-${s.replace(/\//,"-")}`),onSelect:n,onHover:o,isDraggable:r,isFirst:0===t&&0===i},e.key);var s}))},t))),s]})}var le=n(15596);function ce(e){let{children:t}=e;const n=(0,le.u)({shift:!0,wrap:"horizontal"});return(0,E.jsx)(X.Provider,{value:n,children:t})}const ue=(0,m.forwardRef)(((e,t)=>{let{onInsert:n}=e;const[o,i]=(0,m.useState)(""),[r,s]=(0,m.useState)(null),{steps:a,type:l}=(0,p.Z)((e=>({steps:e(P.storeName).getSteps(),type:e(P.storeName).getInserterPopover().type})),[]),c=(0,m.useMemo)((()=>"triggers"===l?[{type:"triggers",title:void 0,label:(0,w.__)("Triggers","mailpoet"),items:a.filter((e=>{let{group:t}=e;return"triggers"===t}))}]:[{type:"actions",title:(0,w.__)("Actions","mailpoet"),label:(0,w.__)("Actions","mailpoet"),items:a.filter((e=>{let{group:t}=e;return"actions"===t}))},{type:"logical",title:(0,w.__)("Logical","mailpoet"),label:(0,w.__)("Logical","mailpoet"),items:a.filter((e=>{let{group:t}=e;return"logical"===t}))}]),[a,l]),u=(0,m.useCallback)((e=>{s(e)}),[s]),d=(0,m.useRef)();(0,m.useImperativeHandle)(t,(()=>({focusSearch:()=>{var e;null===(e=d.current)||void 0===e||e.focus()}})));const g=(0,m.useMemo)((()=>c.map((e=>{return{...e,items:(t=o,n=e.items,n.filter((e=>e.title.toLowerCase().includes(t.trim().toLowerCase()))))};var t,n}))),[o,c]);return(0,E.jsxs)("div",{className:"block-editor-inserter__menu",children:[(0,E.jsx)("div",{className:"block-editor-inserter__main-area",children:(0,E.jsxs)("div",{className:"block-editor-inserter__content",children:[(0,E.jsx)(G.Z,{className:"block-editor-inserter__search",onChange:e=>{r&&s(null),i(e)},value:o,label:(0,w.__)("Search for blocks and patterns"),placeholder:(0,w.__)("Search"),ref:d}),(0,E.jsx)("div",{className:"block-editor-inserter__block-list",children:(0,E.jsxs)(ce,{children:[g.map((e=>e.items.length>0&&(0,E.jsxs)(m.Fragment,{children:[e.title&&(0,E.jsx)("div",{className:"block-editor-inserter__panel-header",children:(0,E.jsx)("h2",{className:"block-editor-inserter__panel-title",children:(0,E.jsx)("div",{children:e.title})})}),(0,E.jsx)("div",{className:"block-editor-inserter__panel-content",children:(0,E.jsx)(ae,{items:e.items,onHover:u,onSelect:e=>n(e),label:e.label})})]},e.type))),0===g.reduce(((e,t)=>{let{items:n}=t;return e+n.length}),0)&&(0,E.jsxs)("div",{className:"block-editor-inserter__no-results",children:[(0,E.jsx)($.Z,{className:"block-editor-inserter__no-results-icon",icon:q.Z}),(0,E.jsx)("p",{children:(0,w.__)("No results found.")})]})]})})]})}),r&&(0,E.jsx)(Q,{item:r})]})}));function de(){const{isSidebarOpened:e,selectedStep:t}=(0,p.Z)((e=>({isSidebarOpened:e(P.storeName).isSidebarOpened,selectedStep:e(P.storeName).getSelectedStep}))),{openSidebar:n,closeSidebar:o,toggleFeature:i}=(0,y.Z)(P.storeName),{registerShortcut:r}=(0,y.Z)(v.h);return(0,m.useEffect)((()=>{r({name:"mailpoet/automation-editor/toggle-fullscreen",category:"global",description:(0,w.__)("Toggle fullscreen mode."),keyCombination:{modifier:"secondary",character:"f"}}),r({name:"mailpoet/automation-editor/toggle-sidebar",category:"global",description:(0,w.__)("Show or hide the settings sidebar."),keyCombination:{modifier:"primaryShift",character:","}})}),[r]),(0,v.bx)("mailpoet/automation-editor/toggle-fullscreen",(()=>{i("fullscreenMode")})),(0,v.bx)("mailpoet/automation-editor/toggle-sidebar",(i=>{if(i.preventDefault(),e())o();else{const e=t()?P.stepSidebarKey:P.workflowSidebarKey;n(e)}})),null}var pe=n(12518),me=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{fillRule:"evenodd",d:"M10.289 4.836A1 1 0 0111.275 4h1.306a1 1 0 01.987.836l.244 1.466c.787.26 1.503.679 2.108 1.218l1.393-.522a1 1 0 011.216.437l.653 1.13a1 1 0 01-.23 1.273l-1.148.944a6.025 6.025 0 010 2.435l1.149.946a1 1 0 01.23 1.272l-.653 1.13a1 1 0 01-1.216.437l-1.394-.522c-.605.54-1.32.958-2.108 1.218l-.244 1.466a1 1 0 01-.987.836h-1.306a1 1 0 01-.986-.836l-.244-1.466a5.995 5.995 0 01-2.108-1.218l-1.394.522a1 1 0 01-1.217-.436l-.653-1.131a1 1 0 01.23-1.272l1.149-.946a6.026 6.026 0 010-2.435l-1.148-.944a1 1 0 01-.23-1.272l.653-1.131a1 1 0 011.217-.437l1.393.522a5.994 5.994 0 012.108-1.218l.244-1.466zM14.929 12a3 3 0 11-6 0 3 3 0 016 0z",clipRule:"evenodd"}));function ge(e){let{sidebarKey:t}=e;const{openSidebar:n}=(0,y.Z)(P.storeName),[o,i]=t===P.workflowSidebarKey?["Workflow (selected)","is-active"]:["Workflow",""],[r,s]=t===P.stepSidebarKey?["Step (selected)","is-active"]:["Step",""];return(0,E.jsxs)("ul",{children:[(0,E.jsx)("li",{children:(0,E.jsx)(c.Z,{onClick:()=>n(P.workflowSidebarKey),className:`edit-site-sidebar__panel-tab ${i}`,"aria-label":o,"data-label":"Workflow",children:"Workflow"})}),(0,E.jsx)("li",{children:(0,E.jsx)(c.Z,{onClick:()=>n(P.stepSidebarKey),className:`edit-site-sidebar__panel-tab ${s}`,"aria-label":r,"data-label":"Workflow",children:"Step"})})]})}var he=n(21840);function fe(e){let{title:t,description:n,icon:o}=e;return(0,E.jsxs)("div",{className:"block-editor-block-card",children:[(0,E.jsx)(J,{icon:o}),(0,E.jsxs)("div",{className:"block-editor-block-card__content",children:[(0,E.jsx)("h2",{className:"block-editor-block-card__title",children:t}),(0,E.jsx)("span",{className:"block-editor-block-card__description",children:n})]})]})}function ve(){const{selectedStep:e,selectedStepType:t}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep(),selectedStepType:e(P.storeName).getSelectedStepType()})),[]);if(!e)return(0,E.jsx)(he.Z,{children:"No step selected."});if(!t)return(0,E.jsx)(he.Z,{children:"Unknown step type."});const n=t.edit;return(0,E.jsxs)("div",{className:"block-editor-block-inspector",children:[(0,E.jsx)(fe,{title:t.title,description:t.description,icon:t.icon}),(0,E.jsx)(n,{}),(0,E.jsxs)(he.Z,{title:"Debug info",initialOpen:!1,children:[(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"ID:"})," ",e.id]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Type:"})," ",e.type]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Key:"})," ",e.key]}),(0,E.jsxs)("div",{children:[(0,E.jsx)("strong",{children:"Args:"})," ",JSON.stringify(e.args)]})]})]})}var _e=n(11345),be=n(34206),ke=n(18439),ye=n(31539),we=n(62668),xe=n(53397);function Se(){const{createErrorNotice:e}=(0,y.Z)(ke.h),{workflow:t}=(0,p.Z)((e=>({workflow:e(P.storeName).getWorkflowData()})),[]);return(0,E.jsx)(c.Z,{isSecondary:!0,isDestructive:!0,onClick:()=>{(0,ye._)({title:"Delete workflow",message:`You are about to delete the “${t.name}” workflow`,cancelLabel:"Cancel",confirmLabel:"Yes, delete",onConfirm:()=>{(0,be.default)({path:`/workflows/${t.id}`,method:"PUT",data:{...t,status:"trash"}}).then((n=>{let{data:o}=n;"trash"===o.status?window.location.href=(0,_.f)(we.x.urls.automationListing,{[xe.E.workflowDeleted]:t.id}):e("An error occurred!",{explicitDismiss:!0})})).catch((()=>{e("An error occurred!",{explicitDismiss:!0})}))}})},children:"Move to Trash"})}function je(){const{workflowData:e}=(0,p.Z)((e=>({workflowData:e(P.storeName).getWorkflowData()})),[]),t={year:"numeric",month:"long",day:"numeric"};return(0,E.jsxs)(he.Z,{title:"Automation details",initialOpen:!0,children:[(0,E.jsxs)(_e.Z,{children:[(0,E.jsx)("strong",{children:"Date added"})," ",new Date(Date.parse(e.created_at)).toLocaleDateString(void 0,t)]}),(0,E.jsxs)(_e.Z,{children:[(0,E.jsx)("strong",{children:"Activated"})," ","active"===e.status&&new Date(Date.parse(e.updated_at)).toLocaleDateString(void 0,t),"active"!==e.status&&e.activated_at&&new Date(Date.parse(e.activated_at)).toLocaleDateString(void 0,t),"active"!==e.status&&!e.activated_at&&(0,E.jsx)("span",{className:"mailpoet-deactive",children:"Not activated yet."})]}),(0,E.jsxs)(_e.Z,{children:[(0,E.jsx)("strong",{children:"Author"})," ",e.author.name]}),(0,E.jsx)(_e.Z,{children:(0,E.jsx)(Se,{})})]})}const Ne=pe.Z.select({web:!0,native:!1});function Pe(e){const{keyboardShortcut:t,sidebarKey:n,showIconLabels:o,workflowName:i}=(0,p.Z)((e=>({keyboardShortcut:e(v.h).getShortcutRepresentation("mailpoet/automation-editor/toggle-sidebar"),sidebarKey:e(f.h).getActiveComplementaryArea(P.storeName)??P.workflowSidebarKey,showIconLabels:e(P.storeName).isFeatureActive("showIconLabels"),workflowName:e(P.storeName).getWorkflowData().name})),[]);return(0,E.jsxs)(f.Vi,{identifier:n,header:(0,E.jsx)(ge,{sidebarKey:n}),closeLabel:(0,w.__)("Close settings"),headerClassName:"edit-site-sidebar__panel-tabs",title:(0,w.__)("Settings"),icon:me,className:"edit-site-sidebar",panelClassName:"edit-site-sidebar",smallScreenTitle:i||(0,w.__)("(no title)"),scope:P.storeName,toggleShortcut:t,isActiveByDefault:Ne,showIconLabels:o,...e,children:[n===P.workflowSidebarKey&&(0,E.jsx)(je,{}),n===P.stepSidebarKey&&(0,E.jsx)(ve,{})]})}var Te=n(73763),Ee=n(86215),Ce=n(61888),Ie=n(74996),Be=n(38104),Ze=n(81963),Ae=n(73703),De=n(4857),Me=n(18024),Le=n(79097),Oe=n.n(Le),Re=n(67257);const Ue={...Re.w0,richEditingEnabled:!0,codeEditingEnabled:!0,enableCustomFields:void 0,supportsLayout:!0};function Ve(e){return e&&"object"==typeof e&&"raw"in e?e.raw:e}var Fe=Oe()({postId:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SETUP_EDITOR_STATE"===t.type?t.post.id:e},postType:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"SETUP_EDITOR_STATE"===t.type?t.post.type:e},saving:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_POST_UPDATE_START":case"REQUEST_POST_UPDATE_FINISH":return{pending:"REQUEST_POST_UPDATE_START"===t.type,options:t.options||{}}}return e},postLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLocked:!1},t=arguments.length>1?arguments[1]:void 0;return"UPDATE_POST_LOCK"===t.type?t.lock:e},template:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isValid:!0},t=arguments.length>1?arguments[1]:void 0;return"SET_TEMPLATE_VALIDITY"===t.type?{...e,isValid:t.isValid}:e},postSavingLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCK_POST_SAVING":return{...e,[t.lockName]:!0};case"UNLOCK_POST_SAVING":return(0,Ce.omit)(e,t.lockName)}return e},isReady:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SETUP_EDITOR_STATE":return!0;case"TEAR_DOWN_EDITOR":return!1}return e},editorSettings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;return"UPDATE_EDITOR_SETTINGS"===t.type?{...e,...t.settings}:e},postAutosavingLock:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCK_POST_AUTOSAVING":return{...e,[t.lockName]:!0};case"UNLOCK_POST_AUTOSAVING":return(0,Ce.omit)(e,t.lockName)}return e}}),He=n(6870),We=n(51691),Ke=n(14462),ze=n(96982),Ge=n(41356),$e=n(53785);const qe=new Set(["meta"]),Je="SAVE_POST_NOTICE_ID",Qe="TRASH_POST_NOTICE_ID",Ye=/%(?:postname|pagename)%/,Xe=["title","excerpt","content"];var et=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{d:"M18.5 10.5H10v8h8a.5.5 0 00.5-.5v-7.5zm-10 0h-3V18a.5.5 0 00.5.5h2.5v-8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),tt=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{fillRule:"evenodd",d:"M18 5.5h-8v8h8.5V6a.5.5 0 00-.5-.5zm-9.5 8h-3V6a.5.5 0 01.5-.5h2.5v8zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),nt=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{d:"M18 5.5H6a.5.5 0 00-.5.5v3h13V6a.5.5 0 00-.5-.5zm.5 5H10v8h8a.5.5 0 00.5-.5v-7.5zM6 4h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2z"})),ot=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{d:"M21.3 10.8l-5.6-5.6c-.7-.7-1.8-.7-2.5 0l-5.6 5.6c-.7.7-.7 1.8 0 2.5l5.6 5.6c.3.3.8.5 1.2.5s.9-.2 1.2-.5l5.6-5.6c.8-.7.8-1.9.1-2.5zm-17.6 1L10 5.5l-1-1-6.3 6.3c-.7.7-.7 1.8 0 2.5L9 19.5l1.1-1.1-6.3-6.3c-.2 0-.2-.2-.1-.3z"}));const it={},rt=[],st=(0,ze.M)((e=>()=>e(Ze.h).hasUndo())),at=(0,ze.M)((e=>()=>e(Ze.h).hasRedo()));function lt(e){return"auto-draft"===mt(e).status}function ct(e){const t=_t(e);return"blocks"in t||"content"in t}const ut=(0,ze.M)((e=>t=>{const n=gt(t),o=ht(t);return!!e(Ze.h).hasEditsForEntityRecord("postType",n,o)})),dt=(0,ze.M)((e=>t=>{const n=e(Ze.h).__experimentalGetDirtyEntityRecords(),{type:o,id:i}=mt(t);return(0,Ce.some)(n,(e=>"postType"!==e.kind||e.name!==o||e.key!==i))}));function pt(e){return!ut(e)&&lt(e)}const mt=(0,ze.M)((e=>t=>{const n=ht(t),o=gt(t);return e(Ze.h).getRawEntityRecord("postType",o,n)||it}));function gt(e){return e.postType}function ht(e){return e.postId}function ft(e){return(0,Ce.get)(mt(e),["_links","version-history",0,"count"],0)}function vt(e){return(0,Ce.get)(mt(e),["_links","predecessor-version",0,"id"],null)}const _t=(0,ze.M)((e=>t=>{const n=gt(t),o=ht(t);return e(Ze.h).getEntityRecordEdits("postType",n,o)||it}));function bt(e,t){switch(t){case"type":return gt(e);case"id":return ht(e);default:const n=mt(e);if(!n.hasOwnProperty(t))break;return Ve(n[t])}}function kt(e,t){if("content"===t)return Ut(e);const n=_t(e);return n.hasOwnProperty(t)?qe.has(t)?((e,t)=>{const n=_t(e);return n.hasOwnProperty(t)?{...bt(e,t),...n[t]}:bt(e,t)})(e,t):n[t]:bt(e,t)}const yt=(0,ze.M)((e=>(t,n)=>{if(!(0,Ce.includes)(Xe,n)&&"preview_link"!==n)return;const o=gt(t),i=ht(t),r=(0,Ce.get)(e(Ze.h).getCurrentUser(),["id"]),s=e(Ze.h).getAutosave(o,i,r);return s?Ve(s[n]):void 0}));function wt(e){return"private"===kt(e,"status")?"private":kt(e,"password")?"password":"public"}function xt(e){return"pending"===mt(e).status}function St(e,t){const n=t||mt(e);return-1!==["publish","private"].indexOf(n.status)||"future"===n.status&&!(0,We.gF)(new Date(Number((0,We._3)(n.date))-6e4))}function jt(e){return"future"===mt(e).status&&!St(e)}function Nt(e){const t=mt(e);return ut(e)||-1===["publish","private","future"].indexOf(t.status)}function Pt(e){return!(Bt(e)||!kt(e,"title")&&!kt(e,"excerpt")&&Tt(e)&&"native"!==pe.Z.OS)}function Tt(e){const t=en(e);if(t.length){if(t.length>1)return!1;const e=t[0].name;if(e!==(0,Ie.UT)()&&e!==(0,Ie.HJ)())return!1}return!Ut(e)}const Et=(0,ze.M)((e=>t=>{if(!Pt(t))return!1;if($t(t))return!1;const n=gt(t),o=ht(t),i=e(Ze.h).hasFetchedAutosaves(n,o),r=(0,Ce.get)(e(Ze.h).getCurrentUser(),["id"]),s=e(Ze.h).getAutosave(n,o,r);return!!i&&(!s||!!ct(t)||["title","excerpt"].some((e=>Ve(s[e])!==kt(t,e))))}));function Ct(e){const t=kt(e,"date"),n=new Date(Number((0,We._3)(t))-6e4);return(0,We.gF)(n)}function It(e){const t=kt(e,"date"),n=kt(e,"modified"),o=mt(e).status;return!("draft"!==o&&"auto-draft"!==o&&"pending"!==o||t!==n&&null!==t)}const Bt=(0,ze.M)((e=>t=>{const n=gt(t),o=ht(t);return e(Ze.h).isSavingEntityRecord("postType",n,o)})),Zt=(0,ze.M)((e=>t=>{const n=e(Ze.h).__experimentalGetEntitiesBeingSaved(),{type:o,id:i}=mt(t);return(0,Ce.some)(n,(e=>"postType"!==e.kind||e.name!==o||e.key!==i))})),At=(0,ze.M)((e=>t=>{const n=gt(t),o=ht(t);return!e(Ze.h).getLastEntitySaveError("postType",n,o)})),Dt=(0,ze.M)((e=>t=>{const n=gt(t),o=ht(t);return!!e(Ze.h).getLastEntitySaveError("postType",n,o)}));function Mt(e){return!!Bt(e)&&!!(0,Ce.get)(e.saving,["options","isAutosave"])}function Lt(e){return!!Bt(e)&&!!(0,Ce.get)(e.saving,["options","isPreview"])}function Ot(e){if(e.saving.pending||Bt(e))return;let t=yt(e,"preview_link");t&&"draft"!==mt(e).status||(t=kt(e,"link"),t&&(t=(0,_.f)(t,{preview:!0})));const n=kt(e,"featured_media");return t&&n?(0,_.f)(t,{_thumbnail_id:n}):t}function Rt(e){const t=en(e);if(t.length>2)return null;let n;if(1===t.length&&(n=t[0].name,"core/embed"===n)){var o;const e=null===(o=t[0].attributes)||void 0===o?void 0:o.providerNameSlug;["youtube","vimeo"].includes(e)?n="core/video":["spotify","soundcloud"].includes(e)&&(n="core/audio")}switch(2===t.length&&"core/paragraph"===t[1].name&&(n=t[0].name),n){case"core/image":return"image";case"core/quote":case"core/pullquote":return"quote";case"core/gallery":return"gallery";case"core/video":return"video";case"core/audio":return"audio";default:return null}}const Ut=(0,ze.M)((e=>t=>{const n=ht(t),o=gt(t),i=e(Ze.h).getEditedEntityRecord("postType",o,n);if(i){if("function"==typeof i.content)return i.content(i);if(i.blocks)return(0,Ie.qm)(i.blocks);if(i.content)return i.content}return""}));function Vt(e){return Bt(e)&&!St(e)&&"publish"===kt(e,"status")}function Ft(e){const t=kt(e,"permalink_template");return Ye.test(t)}function Ht(e){const t=Kt(e);if(!t)return null;const{prefix:n,postName:o,suffix:i}=t;return Ft(e)?n+o+i:n}function Wt(e){return kt(e,"slug")||(0,Ke.J)(kt(e,"title"))||ht(e)}function Kt(e){const t=kt(e,"permalink_template");if(!t)return null;const n=kt(e,"slug")||kt(e,"generated_slug"),[o,i]=t.split(Ye);return{prefix:o,postName:n,suffix:i}}function zt(e){return e.postLock.isLocked}function Gt(e){return Object.keys(e.postSavingLock).length>0}function $t(e){return Object.keys(e.postAutosavingLock).length>0}function qt(e){return e.postLock.isTakeover}function Jt(e){return e.postLock.user}function Qt(e){return e.postLock.activePostLock}function Yt(e){return(0,Ce.has)(mt(e),["_links","wp:action-unfiltered-html"])}const Xt=(0,ze.M)((e=>()=>!!e(U.h).get("core/edit-post","isPublishSidebarEnabled")));function en(e){return kt(e,"blocks")||rt}function tn(e){var t;return(0,Ge.Z)("select('core/editor').getEditorSelectionStart",{since:"5.8",alternative:"select('core/editor').getEditorSelection"}),null===(t=kt(e,"selection"))||void 0===t?void 0:t.selectionStart}function nn(e){var t;return(0,Ge.Z)("select('core/editor').getEditorSelectionStart",{since:"5.8",alternative:"select('core/editor').getEditorSelection"}),null===(t=kt(e,"selection"))||void 0===t?void 0:t.selectionEnd}function on(e){return kt(e,"selection")}function rn(e){return e.isReady}function sn(e){return e.editorSettings}function an(){return(0,Ge.Z)("select('core/editor').getStateBeforeOptimisticTransaction",{since:"5.7",hint:"No state history is kept on this store anymore"}),null}function ln(){return(0,Ge.Z)("select('core/editor').inSomeHistory",{since:"5.7",hint:"No state history is kept on this store anymore"}),!1}function cn(e){return(0,ze.M)((t=>function(n){(0,Ge.Z)("`wp.data.select( 'core/editor' )."+e+"`",{since:"5.3",alternative:"`wp.data.select( 'core/block-editor' )."+e+"`",version:"6.2"});for(var o=arguments.length,i=new Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];return t(Re.t2)[e](...i)}))}const un=cn("getBlockName"),dn=cn("isBlockValid"),pn=cn("getBlockAttributes"),mn=cn("getBlock"),gn=cn("getBlocks"),hn=cn("getClientIdsOfDescendants"),fn=cn("getClientIdsWithDescendants"),vn=cn("getGlobalBlockCount"),_n=cn("getBlocksByClientId"),bn=cn("getBlockCount"),kn=cn("getBlockSelectionStart"),yn=cn("getBlockSelectionEnd"),wn=cn("getSelectedBlockCount"),xn=cn("hasSelectedBlock"),Sn=cn("getSelectedBlockClientId"),jn=cn("getSelectedBlock"),Nn=cn("getBlockRootClientId"),Pn=cn("getBlockHierarchyRootClientId"),Tn=cn("getAdjacentBlockClientId"),En=cn("getPreviousBlockClientId"),Cn=cn("getNextBlockClientId"),In=cn("getSelectedBlocksInitialCaretPosition"),Bn=cn("getMultiSelectedBlockClientIds"),Zn=cn("getMultiSelectedBlocks"),An=cn("getFirstMultiSelectedBlockClientId"),Dn=cn("getLastMultiSelectedBlockClientId"),Mn=cn("isFirstMultiSelectedBlock"),Ln=cn("isBlockMultiSelected"),On=cn("isAncestorMultiSelected"),Rn=cn("getMultiSelectedBlocksStartClientId"),Un=cn("getMultiSelectedBlocksEndClientId"),Vn=cn("getBlockOrder"),Fn=cn("getBlockIndex"),Hn=cn("isBlockSelected"),Wn=cn("hasSelectedInnerBlock"),Kn=cn("isBlockWithinSelection"),zn=cn("hasMultiSelection"),Gn=cn("isMultiSelecting"),$n=cn("isSelectionEnabled"),qn=cn("getBlockMode"),Jn=cn("isTyping"),Qn=cn("isCaretWithinFormattedText"),Yn=cn("getBlockInsertionPoint"),Xn=cn("isBlockInsertionPointVisible"),eo=cn("isValidTemplate"),to=cn("getTemplate"),no=cn("getTemplateLock"),oo=cn("canInsertBlockType"),io=cn("getInserterItems"),ro=cn("hasInserterItems"),so=cn("getBlockListSettings");function ao(e){var t;return null===(t=sn(e))||void 0===t?void 0:t.defaultTemplateTypes}const lo=(0,He.Z)((e=>{var t;const n=(null===(t=sn(e))||void 0===t?void 0:t.defaultTemplatePartAreas)||[];return null==n?void 0:n.map((e=>{return{...e,icon:(t=e.icon,"header"===t?et:"footer"===t?tt:"sidebar"===t?nt:ot)};var t}))}),(e=>{var t;return[null===(t=sn(e))||void 0===t?void 0:t.defaultTemplatePartAreas]})),co=(0,He.Z)(((e,t)=>(0,Ce.find)(ao(e),{slug:t})||{}),((e,t)=>[ao(e),t]));function uo(e,t){var n;if(!t)return{};const{description:o,slug:i,title:r,area:s}=t,{title:a,description:l}=co(e,i),c="string"==typeof r?r:null==r?void 0:r.rendered;return{title:c&&c!==i?c:a||i,description:("string"==typeof o?o:null==o?void 0:o.raw)||l,icon:(null===(n=lo(e).find((e=>s===e.area)))||void 0===n?void 0:n.icon)||$e.Z}}const po=(0,ze.M)((e=>t=>{var n;const o=gt(t),i=e(Ze.h).getPostType(o);return null==i||null===(n=i.labels)||void 0===n?void 0:n.singular_name}));function mo(e,t,n,o,i){window.sessionStorage.setItem(function(e,t){return`wp-autosave-block-editor-post-${t?"auto-draft":e}`}(e,t),JSON.stringify({post_title:n,content:o,excerpt:i}))}function go(e){const{previousPost:t,post:n,postType:o}=e;if((0,Ce.get)(e.options,["isAutosave"]))return[];if("trash"===n.status&&"trash"!==t.status)return[];const i=["publish","private","future"],r=(0,Ce.includes)(i,t.status),s=(0,Ce.includes)(i,n.status);let a,l,c=(0,Ce.get)(o,["viewable"],!1);r||s?r&&!s?(a=o.labels.item_reverted_to_draft,c=!1):a=!r&&s?{publish:o.labels.item_published,private:o.labels.item_published_privately,future:o.labels.item_scheduled}[n.status]:o.labels.item_updated:(a=(0,w.__)("Draft saved."),l=!0);const u=[];return c&&u.push({label:l?(0,w.__)("View Preview"):o.labels.view_item,url:n.link}),[a,{id:Je,type:"snackbar",actions:u}]}function ho(e){const{post:t,edits:n,error:o}=e;if(o&&"rest_autosave_no_changes"===o.code)return[];const i=["publish","private","future"],r=-1!==i.indexOf(t.status),s={publish:(0,w.__)("Publishing failed."),private:(0,w.__)("Publishing failed."),future:(0,w.__)("Scheduling failed.")};let a=r||-1===i.indexOf(n.status)?(0,w.__)("Updating failed."):s[n.status];return o.message&&!/<\/?[^>]*>/.test(o.message)&&(a=[a,o.message].join(" ")),[a,{id:Je}]}const fo=(e,t,n)=>o=>{let{dispatch:i}=o;if(i.setupEditorState(e),"auto-draft"===e.status&&n){let o;o=(0,Ce.has)(t,["content"])?t.content:e.content.raw;let r=(0,Ie.Qc)(o);r=(0,Ie.fw)(r,n),i.resetEditorBlocks(r,{__unstableShouldCreateUndoLevel:!1})}t&&Object.values(t).some((t=>{var n,o;let[i,r]=t;return r!==(null!==(n=null===(o=e[i])||void 0===o?void 0:o.raw)&&void 0!==n?n:e[i])}))&&i.editPost(t)};function vo(){return{type:"TEAR_DOWN_EDITOR"}}function _o(){return(0,Ge.Z)("wp.data.dispatch( 'core/editor' ).resetPost",{since:"6.0",version:"6.3",alternative:"Initialize the editor with the setupEditorState action"}),{type:"DO_NOTHING"}}function bo(){return(0,Ge.Z)("wp.data.dispatch( 'core/editor' ).updatePost",{since:"5.7",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}function ko(e){return{type:"SETUP_EDITOR_STATE",post:e}}const yo=(e,t)=>n=>{let{select:o,registry:i}=n;const{id:r,type:s}=o.getCurrentPost();i.dispatch(Ze.h).editEntityRecord("postType",s,r,e,t)},wo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async t=>{let{select:n,dispatch:o,registry:i}=t;if(!n.isEditedPostSaveable())return;const r=n.getEditedPostContent();e.isAutosave||o.editPost({content:r},{undoIgnore:!0});const s=n.getCurrentPost(),a={id:s.id,...i.select(Ze.h).getEntityRecordNonTransientEdits("postType",s.type,s.id),content:r};o({type:"REQUEST_POST_UPDATE_START",options:e}),await i.dispatch(Ze.h).saveEntityRecord("postType",s.type,a,e),o({type:"REQUEST_POST_UPDATE_FINISH",options:e});const l=i.select(Ze.h).getLastEntitySaveError("postType",s.type,s.id);if(l){const e=ho({post:s,edits:a,error:l});e.length&&i.dispatch(ke.h).createErrorNotice(...e)}else{const t=n.getCurrentPost(),o=go({previousPost:s,post:t,postType:await i.resolveSelect(Ze.h).getPostType(t.type),options:e});o.length&&i.dispatch(ke.h).createSuccessNotice(...o),e.isAutosave||i.dispatch(Re.t2).__unstableMarkLastChangeAsPersistent()}}};function xo(){return(0,Ge.Z)("wp.data.dispatch( 'core/editor' ).refreshPost",{since:"6.0",version:"6.3",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}const So=()=>async e=>{let{select:t,dispatch:n,registry:o}=e;const i=t.getCurrentPostType(),r=await o.resolveSelect(Ze.h).getPostType(i);o.dispatch(ke.h).removeNotice(Qe);const{rest_base:s,rest_namespace:a="wp/v2"}=r;try{const e=t.getCurrentPost();await(0,be.default)({path:`/${a}/${s}/${e.id}`,method:"DELETE"}),await n.savePost()}catch(e){o.dispatch(ke.h).createErrorNotice(...(l={error:e},[l.error.message&&"unknown_error"!==l.error.code?l.error.message:(0,w.__)("Trashing failed"),{id:Qe}]))}var l},jo=function(){let{local:e=!1,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async n=>{let{select:o,dispatch:i}=n;if(e){const e=o.getCurrentPost(),t=o.isEditedPostNew(),n=o.getEditedPostAttribute("title"),i=o.getEditedPostAttribute("content"),r=o.getEditedPostAttribute("excerpt");mo(e.id,t,n,i,r)}else await i.savePost({isAutosave:!0,...t})}},No=()=>e=>{let{registry:t}=e;t.dispatch(Ze.h).redo()},Po=()=>e=>{let{registry:t}=e;t.dispatch(Ze.h).undo()};function To(){return(0,Ge.Z)("wp.data.dispatch( 'core/editor' ).createUndoLevel",{since:"6.0",version:"6.3",alternative:"Use the core entities store instead"}),{type:"DO_NOTHING"}}function Eo(e){return{type:"UPDATE_POST_LOCK",lock:e}}const Co=()=>e=>{let{registry:t}=e;t.dispatch(U.h).set("core/edit-post","isPublishSidebarEnabled",!0)},Io=()=>e=>{let{registry:t}=e;t.dispatch(U.h).set("core/edit-post","isPublishSidebarEnabled",!1)};function Bo(e){return{type:"LOCK_POST_SAVING",lockName:e}}function Zo(e){return{type:"UNLOCK_POST_SAVING",lockName:e}}function Ao(e){return{type:"LOCK_POST_AUTOSAVING",lockName:e}}function Do(e){return{type:"UNLOCK_POST_AUTOSAVING",lockName:e}}const Mo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{select:o,dispatch:i,registry:r}=n;const{__unstableShouldCreateUndoLevel:s,selection:a}=t,l={blocks:e,selection:a};if(!1!==s){const{id:e,type:t}=o.getCurrentPost();if(r.select(Ze.h).getEditedEntityRecord("postType",t,e).blocks===l.blocks)return void r.dispatch(Ze.h).__unstableCreateUndoLevel("postType",t,e);l.content=e=>{let{blocks:t=[]}=e;return(0,Ie.qm)(t)}}i.editPost(l)}};function Lo(e){return{type:"UPDATE_EDITOR_SETTINGS",settings:e}}const Oo=e=>function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return t=>{let{registry:o}=t;(0,Ge.Z)("`wp.data.dispatch( 'core/editor' )."+e+"`",{since:"5.3",alternative:"`wp.data.dispatch( 'core/block-editor' )."+e+"`",version:"6.2"}),o.dispatch(Re.t2)[e](...n)}},Ro=Oo("resetBlocks"),Uo=Oo("receiveBlocks"),Vo=Oo("updateBlock"),Fo=Oo("updateBlockAttributes"),Ho=Oo("selectBlock"),Wo=Oo("startMultiSelect"),Ko=Oo("stopMultiSelect"),zo=Oo("multiSelect"),Go=Oo("clearSelectedBlock"),$o=Oo("toggleSelection"),qo=Oo("replaceBlocks"),Jo=Oo("replaceBlock"),Qo=Oo("moveBlocksDown"),Yo=Oo("moveBlocksUp"),Xo=Oo("moveBlockToPosition"),ei=Oo("insertBlock"),ti=Oo("insertBlocks"),ni=Oo("showInsertionPoint"),oi=Oo("hideInsertionPoint"),ii=Oo("setTemplateValidity"),ri=Oo("synchronizeTemplate"),si=Oo("mergeBlocks"),ai=Oo("removeBlocks"),li=Oo("removeBlock"),ci=Oo("toggleBlockMode"),ui=Oo("startTyping"),di=Oo("stopTyping"),pi=Oo("enterFormattedText"),mi=Oo("exitFormattedText"),gi=Oo("insertDefaultBlock"),hi=Oo("updateBlockListSettings"),fi={reducer:Fe,selectors:o,actions:i},vi=(0,Me.Z)("core/editor",{...fi});function _i(e){const t=(0,Ce.mapValues)((0,Ce.pickBy)(e.attributes,{source:"meta"}),"meta");return(0,Ce.isEmpty)(t)||(e.edit=(e=>(0,Ae.o)((t=>n=>{let{attributes:o,setAttributes:i,...r}=n;const s=(0,p.Z)((e=>e(vi).getCurrentPostType()),[]),[a,l]=(0,Ze.Mi)("postType",s,"meta"),c=(0,m.useMemo)((()=>({...o,...(0,Ce.mapValues)(e,(e=>a[e]))})),[o,a]);return(0,m.createElement)(t,(0,Ee.Z)({attributes:c,setAttributes:t=>{const n=(0,Ce.mapKeys)((0,Ce.pickBy)(t,((t,n)=>e[n])),((t,n)=>e[n]));(0,Ce.isEmpty)(n)||l(n),i(t)}},r))}),"withMetaAttributeSource"))(t)(e.edit)),e}function bi(e){const t=e.avatar_urls&&e.avatar_urls[24]?(0,m.createElement)("img",{className:"editor-autocompleters__user-avatar",alt:"",src:e.avatar_urls[24]}):(0,m.createElement)("span",{className:"editor-autocompleters__no-avatar"});return(0,m.createElement)(m.Fragment,null,t,(0,m.createElement)("span",{className:"editor-autocompleters__user-name"},e.name),(0,m.createElement)("span",{className:"editor-autocompleters__user-slug"},e.slug))}(0,Be.register)(vi),(0,De.KJ)("blocks.registerBlockType","core/editor/custom-sources-backwards-compatibility/shim-attribute-source",_i),(0,Be.select)(Ie.h).getBlockTypes().map((e=>{let{name:t}=e;return(0,Be.select)(Ie.h).getBlockType(t)})).forEach(_i);var ki={name:"users",className:"editor-autocompleters__user",triggerPrefix:"@",useItems(e){const t=(0,p.Z)((t=>{const{getUsers:n}=t(Ze.h);return n({context:"view",search:encodeURIComponent(e)})}),[e]),n=(0,m.useMemo)((()=>t?t.map((e=>({key:`user-${e.slug}`,value:e,label:bi(e)}))):[]),[t]);return[n]},getOptionCompletion:e=>`@${e.slug}`};(0,De.KJ)("editor.Autocomplete.completers","editor/autocompleters/set-default-completers",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.push((0,Ce.clone)(ki)),e}));var yi=n(81535),wi=n(5523),xi=n(19006),Si=n(79496),ji=n(99318),Ni=(0,Si.Z)([(0,wi.Z)((e=>({isValid:e(Re.t2).isValidTemplate()}))),(0,xi.Z)((e=>{const{setTemplateValidity:t,synchronizeTemplate:n}=e(Re.t2);return{resetTemplateValidity:()=>t(!0),synchronizeTemplate:n}}))])((function(e){let{isValid:t,...n}=e;return t?null:(0,m.createElement)(ji.Z,{className:"editor-template-validation-notice",isDismissible:!1,status:"warning",actions:[{label:(0,w.__)("Keep it as is"),onClick:n.resetTemplateValidity},{label:(0,w.__)("Reset the template"),onClick:()=>{window.confirm((0,w.__)("Resetting the template may result in loss of content, do you want to continue?"))&&n.synchronizeTemplate()}}]},(0,w.__)("The content of your post doesn’t match the template assigned to your post type."))})),Pi=(0,Si.Z)([(0,wi.Z)((e=>({notices:e(ke.h).getNotices()}))),(0,xi.Z)((e=>({onRemove:e(ke.h).removeNotice})))])((function(e){let{notices:t,onRemove:n}=e;const o=(0,Ce.filter)(t,{isDismissible:!0,type:"default"}),i=(0,Ce.filter)(t,{isDismissible:!1,type:"default"});return(0,m.createElement)(m.Fragment,null,(0,m.createElement)(yi.Z,{notices:i,className:"components-editor-notices__pinned"}),(0,m.createElement)(yi.Z,{notices:o,className:"components-editor-notices__dismissible",onRemove:n},(0,m.createElement)(Ni,null)))})),Ti=n(34517);const Ei=(0,m.createContext)(void 0);function Ci(){return(0,E.jsx)("div",{className:"mailpoet-automation-editor-empty-workflow",children:"No workflow data."})}function Ii(e){let{onClick:t,previousStepId:n}=e;const o=(0,m.useContext)(Ei);return(0,E.jsx)(Y.A,{state:o,role:"treeitem",className:"mailpoet-automation-editor-add-step-button",focusable:!0,"data-previous-step-id":n,onClick:e=>{e.stopPropagation();const n=e.target.closest("button");t(n)},children:(0,E.jsx)($.Z,{icon:Z.Z,size:16})})}function Bi(e){let{previousStepId:t}=e;const{setInserterPopover:n}=(0,Be.dispatch)(P.storeName);return(0,E.jsx)("div",{className:"mailpoet-automation-editor-separator",children:(0,E.jsx)(Ii,{onClick:e=>n({anchor:e,type:"steps"}),previousStepId:t})})}var Zi=n(78869),Ai=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{fillRule:"evenodd",d:"M8.95 11.25H4v1.5h4.95v4.5H13V18c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2h-3c-1.1 0-2 .9-2 2v.75h-2.55v-7.5H13V9c0 1.1.9 2 2 2h3c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3c-1.1 0-2 .9-2 2v.75H8.95v4.5ZM14.5 15v3c0 .3.2.5.5.5h3c.3 0 .5-.2.5-.5v-3c0-.3-.2-.5-.5-.5h-3c-.3 0-.5.2-.5.5Zm0-6V6c0-.3.2-.5.5-.5h3c.3 0 .5.2.5.5v3c0 .3-.2.5-.5.5h-3c-.3 0-.5-.2-.5-.5Z",clipRule:"evenodd"})),Di=n(83115),Mi=n(62006),Li=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{d:"M20 5h-5.7c0-1.3-1-2.3-2.3-2.3S9.7 3.7 9.7 5H4v2h1.5v.3l1.7 11.1c.1 1 1 1.7 2 1.7h5.7c1 0 1.8-.7 2-1.7l1.7-11.1V7H20V5zm-3.2 2l-1.7 11.1c0 .1-.1.2-.3.2H9.1c-.1 0-.3-.1-.3-.2L7.2 7h9.6z"})),Oi=n(77333);const{currentWpUserEmail:Ri,MailPoetComUrlFactory:{getPurchasePlanUrl:Ui,getUpgradeUrl:Vi},subscribersLimitReached:Fi,subscribersCount:Hi,premiumActive:Wi,hasValidApiKey:Ki,hasValidPremiumKey:zi,isPremiumPluginInstalled:Gi,pluginPartialKey:$i,premiumPluginActivationUrl:qi}=we.x;let Ji=Gi;const Qi=async e=>we.x.Ajax.post({api_version:we.x.apiVersion,endpoint:"premium",action:e}),Yi=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0;const n=e?{utm_source:"plugin",...e}:void 0;return zi||Ki?!zi&&Ki?{title:(0,w.__)("Upgrade your MailPoet plan","mailpoet"),info:(0,w.__)("Please upgrade your MailPoet plan.","mailpoet"),cta:(0,w.__)("Upgrade","mailpoet"),action:Vi($i)}:Fi?{title:(0,w.__)("Subscribers limit reached","mailpoet"),info:(0,w.__)("Please upgrade your MailPoet plan to continue using MailPoet.","mailpoet"),cta:(0,w.__)("Upgrade","mailpoet"),action:Vi($i)}:zi&&!Ji?{title:(0,w.__)("Download the MailPoet Premium plugin","mailpoet"),info:(0,w.__)("Please download the MailPoet Premium plugin.","mailpoet"),cta:(0,w.__)("Download","mailpoet"),action:{handler:async()=>{await Qi("installPlugin"),Ji=!0,t()},busy:(0,w.__)("Downloading…","mailpoet"),success:(0,w.__)("Activate","mailpoet"),successHandler:()=>window.open(qi,"_blank").focus(),error:(0,w.__)("Plugin installation failed.","mailpoet")}}:zi&&!Wi?{title:(0,w.__)("Activate the MailPoet Premium plugin","mailpoet"),info:(0,w.__)("Please activate the MailPoet Premium plugin.","mailpoet"),cta:(0,w.__)("Activate","mailpoet"),action:{handler:async()=>Qi("activatePlugin"),busy:(0,w.__)("Activating…","mailpoet"),success:(0,w.__)("Reload the page","mailpoet"),successHandler:()=>window.location.reload(),error:(0,w.__)("Plugin activation failed.","mailpoet")}}:{title:(0,w.__)("MailPoet Premium is active","mailpoet"),info:(0,w.__)("The MailPoet Premium plugin was activated. Please reload the page.","mailpoet"),cta:(0,w.__)("Reload the page","mailpoet"),action:window.location.href}:{title:(0,w.__)("Purchase a MailPoet plan","mailpoet"),info:(0,w.__)("Please purchase a MailPoet plan.","mailpoet"),cta:(0,w.__)("Purchase","mailpoet"),action:Ui(Hi,Ri,"business",n)}},Xi=zi&&!Fi&&we.x.premiumActive,er=(e,t)=>{const{action:n,cta:o}=t;return"string"==typeof n?o:"busy"===e?n.busy:"success"===e?n.success:o};function tr(e){let{children:t,tracking:n,...o}=e;const[i,r]=(0,m.useState)(),s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;const[t,n]=(0,m.useState)((()=>{const t=()=>n(Yi(e,t));return Yi(e,t)}));return t}(n);(0,m.useEffect)((()=>{r(void 0)}),[s]);const a=(0,m.useCallback)((async()=>{if("string"!=typeof s.action)if("success"!==i){r("busy");try{await s.action.handler(),r("success")}catch(e){r("error")}}else s.action.successHandler()}),[i,s.action]);return(0,E.jsxs)(Oi.Z,{className:"mailpoet-premium-modal",title:s.title,closeButtonLabel:(0,w.__)("Cancel","mailpoet"),...o,children:[(0,E.jsxs)("div",{children:[!Xi&&t," ",s.info]}),(0,E.jsxs)("div",{className:"mailpoet-premium-modal-footer",children:[(0,E.jsx)(c.Z,{variant:"tertiary",onClick:o.onRequestClose,children:(0,w.__)("Cancel","mailpoet")}),"string"==typeof s.action?(0,E.jsx)(c.Z,{variant:"primary",href:s.action,target:"_blank",rel:"noopener noreferrer",children:s.cta}):(0,E.jsx)(c.Z,{variant:"primary",isBusy:"busy"===i,disabled:"busy"===i,onClick:a,children:er(i,s)})]}),"string"!=typeof s.action&&"error"===i&&(0,E.jsx)("div",{className:"mailpoet-premium-modal-error",children:(0,E.jsxs)(S.Z,{isDestructive:!0,children:[s.action.error," ",(0,w.__)("Please try again.","mailpoet")]})})]})}function nr(e){let{step:t}=e;const[n,o]=(0,m.useState)(!1),i=(0,m.useCallback)((e=>{Ti.Hooks.applyFilters("mailpoet.automation.workflow.delete_step_callback",(()=>{o(!0)}))(e)}),[]);return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"mailpoet-automation-step-more-menu",children:(0,E.jsx)(Di.Z,{label:(0,w.__)("More","mailpoet"),icon:Mi.Z,controls:[{title:(0,w.__)("Delete step","mailpoet"),icon:Li,onClick:()=>i(t)}],popoverProps:{position:"bottom right"},toggleProps:{isSmall:!0}})}),n&&(0,E.jsx)(tr,{onRequestClose:()=>{o(!1)},tracking:{utm_medium:"upsell_modal",utm_campaign:"remove_automation_step"},children:(0,w.__)("You cannot remove a new step from the automation.","mailpoet")})]})}function or(e){let{foreground:t,background:n,...o}=e;return(0,E.jsx)("div",{className:"mailpoet-automation-colored-icon",style:{width:o.width,height:o.height,backgroundColor:n,fill:t},children:(0,E.jsx)(u.Z,{...o})})}function ir(e){let{step:t,isSelected:n}=e;const{stepType:o}=(0,p.Z)((e=>({stepType:e(P.storeName).getStepType(t.key)})),[t]),{openSidebar:i,selectStep:r}=(0,y.Z)(P.storeName),a=(0,m.useContext)(Ei),{batch:l}=(0,Zi.Z)(),c=o??(e=>{const t="trigger"===e.type;return{title:t?(0,w.__)("Unknown trigger","mailpoet"):(0,w.__)("Unknown step","mailpoet"),subtitle:()=>t?(0,w.__)("Trigger type not registered","mailpoet"):(0,w.__)("Step type not registered","mailpoet"),description:t?(0,w.__)("Unknown trigger","mailpoet"):(0,w.__)("Unknown step","mailpoet"),group:"trigger"===e.type?"triggers":"actions",key:e.key,foreground:"#8c8f94",background:"#dcdcde",edit:()=>null,icon:()=>Ai}})(t);return(0,E.jsxs)("div",{className:"mailpoet-automation-editor-step-wrapper",children:[(0,E.jsx)(nr,{step:t}),(0,E.jsxs)(Y.A,{state:a,role:"treeitem",className:s()({"mailpoet-automation-editor-step":!0,"is-selected-step":n,"is-unknown-step":!o}),focusable:!0,onClick:()=>l((()=>{i(P.stepSidebarKey),r(t)})),children:[(0,E.jsx)("div",{className:"mailpoet-automation-editor-step-icon",children:(0,E.jsx)(or,{icon:c.icon,foreground:c.foreground,background:c.background,width:"23px",height:"23px"})}),(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{className:"mailpoet-automation-editor-step-title",children:c.title}),(0,E.jsx)("div",{className:"mailpoet-automation-editor-step-subtitle",children:c.subtitle(t)})]})]},t.id)]})}function rr(){const e=(0,m.useRef)(),[t,n]=(0,m.useState)(!1),{inserterPopover:o}=(0,p.Z)((e=>({inserterPopover:e(P.storeName).getInserterPopover()})),[]),{setInserterPopover:i}=(0,y.Z)(P.storeName),r=(0,m.useCallback)((e=>{Ti.Hooks.applyFilters("mailpoet.automation.workflow.add_step_callback",(()=>{n(!0)}))(e)}),[]);return o?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(d.Z,{ref:e,anchorRect:o.anchor.getBoundingClientRect(),onClose:()=>{t||i(void 0)},children:(0,E.jsx)(ue,{onInsert:r})}),t&&(0,E.jsx)(tr,{onRequestClose:()=>{var t;n(!1),null===(t=e.current)||void 0===t||t.focus()},tracking:{utm_medium:"upsell_modal",utm_campaign:"add_automation_step"},children:(0,w.__)("You cannot add a new step to the automation.","mailpoet")})]}):null}function sr(e){let{step:t}=e;const n=(0,m.useContext)(Ei),{setInserterPopover:o}=(0,y.Z)(P.storeName);return(0,E.jsxs)(Y.A,{state:n,role:"treeitem",className:"mailpoet-automation-workflow-add-trigger","data-step-id":t.id,focusable:!0,onClick:e=>{e.stopPropagation(),o({anchor:e.target.closest("button"),type:"triggers"})},children:[(0,E.jsx)($.Z,{icon:Z.Z,size:16}),(0,w.__)("Add trigger","mailpoet")]})}function ar(){const{workflowData:e,selectedStep:t}=(0,p.Z)((e=>({workflowData:e(P.storeName).getWorkflowData(),selectedStep:e(P.storeName).getSelectedStep()})),[]),n=(0,le.u)({orientation:"vertical",wrap:"horizontal",shift:!0}),o=(null==e?void 0:e.steps)??void 0,i=(0,m.useMemo)((()=>Object.values(o??{}).filter((e=>{let{type:t}=e;return"trigger"===t}))),[o]),r=(0,m.useMemo)((()=>{if(!o||i.length<1)return[];const e=[i[0]];for(;;){const t=e[e.length-1];if(!("next_step_id"in t)||!t.next_step_id||!o[t.next_step_id])break;e.push(o[t.next_step_id])}return e}),[i,o]),s=(0,m.useMemo)((()=>Ti.Hooks.applyFilters("mailpoet.automation.workflow.render_step",(e=>"trigger"===e.type&&"core:empty"===e.key?(0,E.jsx)(sr,{step:e}):(0,E.jsx)(ir,{step:e,isSelected:t&&e.id===t.id})))),[t]),a=(0,m.useMemo)((()=>Ti.Hooks.applyFilters("mailpoet.automation.workflow.render_step_separator",(e=>(0,E.jsx)(Bi,{previousStepId:e.id})))),[]);return e?(0,E.jsxs)(Ei.Provider,{value:n,children:[(0,E.jsx)(Pi,{}),(0,E.jsxs)(Te.b,{state:n,role:"tree","aria-orientation":"vertical",className:"mailpoet-automation-editor-workflow",children:[(0,E.jsxs)("div",{className:"mailpoet-automation-editor-workflow-wrapper",children:[(0,E.jsx)("div",{}),r.map((e=>(0,E.jsxs)(m.Fragment,{children:[s(e),a(e)]},e.id))),(0,E.jsx)($.Z,{className:"mailpoet-automation-editor-workflow-end",icon:O.Z}),(0,E.jsx)("div",{})]}),(0,E.jsx)(rr,{})]})]}):(0,E.jsx)(Ci,{})}var lr=n(93702),cr=n(9090),ur=n(6258),dr=n(97873);function pr(e){let{title:t,children:n}=e;return(0,E.jsxs)("h2",{className:"components-panel__body-title mailpoet-automation-panel-plain-body-title",children:[(0,E.jsx)("div",{className:"mailpoet-automation-panel-plain-body-title-text",children:t}),n]})}function mr(e){return(0,E.jsx)("div",{className:"mailpoet-automation-panel-plain-body-title-action",children:(0,E.jsx)(c.Z,{...e})})}const gr=[{label:"Hours",subtitle:e=>`Wait for ${e} ${1===e?"hour":"hours"}`,value:"HOURS"},{label:"Days",subtitle:e=>`Wait for ${e} ${1===e?"day":"days"}`,value:"DAYS"},{label:"Weeks",subtitle:e=>`Wait for ${e} ${1===e?"week":"weeks"}`,value:"WEEKS"}],hr={key:"core:delay",group:"actions",title:"Delay",foreground:"#7F54B3",background:"#f7edf7",description:"Wait some time before proceeding with the steps below",subtitle:e=>{return e.args.delay&&e.args.delay_type?(t=e.args.delay_type,n=e.args.delay,gr.reduce(((e,o)=>o.value!==t?e:o.subtitle(n)),"")):"Not set up yet.";var t,n},icon:function(){return(0,E.jsx)("svg",{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,E.jsx)("path",{d:"M9.79683 0.666656C4.6635 0.666656 0.463501 4.86666 0.463501 9.99999C0.463501 15.1333 4.6635 19.3333 9.79683 19.3333C14.9302 19.3333 19.1302 15.1333 19.1302 9.99999C19.1302 4.86666 14.9302 0.666656 9.79683 0.666656ZM9.79683 17.4667C5.68083 17.4667 2.33017 14.116 2.33017 9.99999C2.33017 5.88399 5.68083 2.53332 9.79683 2.53332C13.9128 2.53332 17.2635 5.88399 17.2635 9.99999C17.2635 14.116 13.9128 17.4667 9.79683 17.4667ZM10.2635 5.33332H8.8635V10.9333L13.7168 13.92L14.4635 12.7067L10.2635 10.1867V5.33332Z"})})},edit:function(){const{selectedStep:e}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep()})),[]);return(0,E.jsxs)(he.Z,{opened:!0,children:[(0,E.jsx)(pr,{title:"Wait for"}),(0,E.jsxs)(cr.Z,{align:"top",children:[(0,E.jsx)(ur.Z,{style:{flex:"1 1 0"},children:(0,E.jsx)(k.Z,{label:"",type:"number",placeholder:"Number",value:e.args.delay??"",onChange:t=>{const n=0===t.length||parseInt(t,10)<1?1:parseInt(t,10);(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"delay",n)}})}),(0,E.jsx)(ur.Z,{style:{flex:"1 1 0"},children:(0,E.jsx)(dr.Z,{label:"",value:e.args.delay_type??"HOURS",options:gr,onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"delay_type",t)})})]})]})}};var fr=n(52405);function vr(e){let{centered:t,variant:n,...o}=e;return(0,E.jsx)(c.Z,{className:s()(["sidebar-primary"===n?"mailpoet-automation-button-sidebar-primary":"",t?"mailpoet-automation-button-centered":""]),variant:"sidebar-primary"===n?"primary":n,...o})}function _r(){var e;const[t,n]=(0,m.useState)(!1),{selectedStep:o,workflowId:i,workflowSaved:r}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep(),workflowId:e(P.storeName).getWorkflowData().id,workflowSaved:e(P.storeName).getSelectedStep()})),[]),s=null==o||null===(e=o.args)||void 0===e?void 0:e.email_id,a=o.id,l=(0,m.useCallback)((async()=>{n(!0);const e=await we.x.Ajax.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"create",data:{type:"automation",subject:"",options:{workflowId:i,workflowStepId:a}}});(0,Be.dispatch)(P.storeName).updateStepArgs(a,"email_id",parseInt(e.data.id,10)),(0,Be.dispatch)(P.storeName).save()}),[i,a]);return(0,m.useEffect)((()=>{s&&r&&(window.location.href=`admin.php?page=mailpoet-newsletter-editor&id=${s}`)}),[s,r]),(0,E.jsx)(vr,{variant:"sidebar-primary",centered:!0,icon:Z.Z,onClick:l,isBusy:t,disabled:t,children:"Design email"})}var br=n(3386),kr=n(11699);const yr=br.ZP;function wr(e){let{emailId:t}=e;const[n,o]=(0,m.useState)();return(0,m.useEffect)((()=>{(async()=>{var e;const n=await kr.G.post({api_version:window.mailpoet_api_version,endpoint:"newsletters",action:"get",data:{id:t}});null!=n&&null!==(e=n.data)&&void 0!==e&&e.thumbnail_url&&o(n.data.thumbnail_url)})()}),[t]),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{className:"mailpoet-automation-thumbnail-box",children:n?(0,E.jsx)("div",{className:"mailpoet-automation-thumbnail-wrapper",children:(0,E.jsx)("img",{className:"mailpoet-automation-thumbnail-image",src:n,alt:"Email thumbnail"})}):(0,E.jsx)(yr,{className:"mailpoet-automation-thumbnail-spinner"})}),(0,E.jsxs)("div",{className:"mailpoet-automation-thumbnail-buttons",children:[(0,E.jsx)(vr,{variant:"sidebar-primary",centered:!0,href:`?page=mailpoet-newsletter-editor&id=${t}`,children:"Edit content"}),(0,E.jsx)(vr,{variant:"secondary",centered:!0,children:"Preview"})]})]})}var xr=n(9578);function Sr(e){let{currentName:t,defaultName:n,update:o}=e;return(0,E.jsx)(x.Z,{className:"mailpoet-step-name-dropdown",contentClassName:"mailpoet-step-name-popover",position:"bottom left",renderToggle:e=>{let{isOpen:o,onToggle:i}=e;return(0,E.jsx)(pr,{title:t.length>0?t:n,children:(0,E.jsx)(mr,{onClick:i,"aria-expanded":o,"aria-label":"Edit step name",children:(0,E.jsx)($.Z,{icon:xr.Z,size:16})})})},renderContent:()=>(0,E.jsx)(k.Z,{label:"Step name",className:"mailpoet-step-name-input",placeholder:n,value:t,onChange:o,help:"Give the automation step a name that indicates its purpose. E.g “Abandoned cart recovery”. This name will be displayed only to you and not to the clients."})})}function jr(e){return(0,E.jsx)(fr.Z,{...e,onChange:t=>e.onChange(t.replaceAll(/(\r?\n)+/g," ")),onKeyDown:t=>{"Enter"===t.key&&t.preventDefault(),e.onKeyDown&&e.onKeyDown(t)}})}function Nr(){const{selectedStep:e,selectedStepType:t}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep(),selectedStepType:e(P.storeName).getSelectedStepType()})),[]);return(0,E.jsxs)(he.Z,{opened:!0,children:[(0,E.jsx)(Sr,{currentName:e.args.name??"",defaultName:t.title,update:t=>{(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"name",t)}}),(0,E.jsx)(k.Z,{label:"“From” name",placeholder:"John Doe",value:e.args.sender_name??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"sender_name",t)}),(0,E.jsx)(k.Z,{type:"email",label:"“From” email address",placeholder:"you@domain.com",value:e.args.sender_address??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"sender_address",t)}),(0,E.jsx)(jr,{label:"Subject",placeholder:"Type in subject…",value:e.args.subject??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"subject",t)}),(0,E.jsx)(jr,{label:"Preheader",placeholder:"Type in preheader…",value:e.args.preheader??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"preheader",t)}),(0,E.jsx)("div",{className:"mailpoet-automation-email-content-separator"}),(0,E.jsx)(pr,{title:"Email content"}),e.args.email_id?(0,E.jsx)(wr,{emailId:e.args.email_id}):(0,E.jsx)(_r,{})]})}var Pr=n(58897);function Tr(){var e;const{selectedStep:t}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep()})),[]),n=void 0!==(null===(e=t.args)||void 0===e?void 0:e.ga_campaign),o=Ti.Hooks.applyFilters("mailpoet.automation.send_email.google_analytics_panel",(0,E.jsx)(tr,{onRequestClose:()=>(0,Be.dispatch)(P.storeName).updateStepArgs(t.id,"ga_campaign",void 0),children:(0,w.__)("Google Analytics tracking is not available in the free version of the MailPoet plugin.","mailpoet")}));return(0,E.jsxs)(he.Z,{title:"Google analytics",initialOpen:!1,children:[(0,E.jsx)(Pr.Z,{label:"Enable custom GA tracking",checked:n,onChange:e=>(0,Be.dispatch)(P.storeName).updateStepArgs(t.id,"ga_campaign",e?"":void 0)}),n&&o]})}function Er(){const{selectedStep:e}=(0,p.Z)((e=>({selectedStep:e(P.storeName).getSelectedStep()})),[]),t=e.args.reply_to_name,n=e.args.reply_to_address,o=void 0!==t||void 0!==n;return(0,E.jsxs)(he.Z,{title:"Reply to",initialOpen:!1,children:[(0,E.jsx)(Pr.Z,{label:"Use different email address for getting replies to the email",checked:o,onChange:t=>{(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"reply_to_name",t?"":void 0),(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"reply_to_address",t?"":void 0)}}),o&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(k.Z,{label:"“Reply to” name",placeholder:"John Doe",value:t??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"reply_to_name",t)}),(0,E.jsx)(k.Z,{type:"email",label:"“Reply to” email address",placeholder:"you@domain.com",value:n??"",onChange:t=>(0,Be.dispatch)(P.storeName).updateStepArgs(e.id,"reply_to_address",t)})]})]})}const Cr={key:"mailpoet:send-email",group:"actions",title:"Send email",description:"An email will be sent to subscriber",subtitle:e=>e.args.name??"Send email",foreground:"#996800",background:"#FCF9E8",icon:function(){return(0,E.jsx)("svg",{viewBox:"0 0 16 12",xmlns:"http://www.w3.org/2000/svg",children:(0,E.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.73578 1.5L8 6.01219L13.2642 1.5H2.73578ZM14.5 2.41638L8.48809 7.56944L8 7.98781L7.51191 7.56944L1.5 2.41638V10C1.5 10.2761 1.72386 10.5 2 10.5H14C14.2761 10.5 14.5 10.2761 14.5 10V2.41638ZM0 2C0 0.89543 0.89543 0 2 0H14C15.1046 0 16 0.895431 16 2V10C16 11.1046 15.1046 12 14 12H2C0.895431 12 0 11.1046 0 10V2Z"})})},edit:function(){return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(Nr,{}),(0,E.jsx)(Er,{}),(0,E.jsx)(Tr,{})]})}};var Ir=(0,m.createElement)(g.Wj,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,m.createElement)(g.y$,{fillRule:"evenodd",d:"M7.25 16.437a6.5 6.5 0 1 1 9.5 0V16A2.75 2.75 0 0 0 14 13.25h-4A2.75 2.75 0 0 0 7.25 16v.437Zm1.5 1.193a6.47 6.47 0 0 0 3.25.87 6.47 6.47 0 0 0 3.25-.87V16c0-.69-.56-1.25-1.25-1.25h-4c-.69 0-1.25.56-1.25 1.25v1.63ZM4 12a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm10-2a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z",clipRule:"evenodd"}));const Br={key:"mailpoet:segment:subscribed",group:"triggers",title:(0,w.__)("Someone subscribed","mailpoet"),foreground:"#2271b1",background:"#f0f6fc",description:(0,w.__)("Starts the automation when a new subscriber is added to MailPoet. Use trigger filters to filter by a specific list.","mailpoet"),subtitle:()=>(0,w.__)("Trigger","mailpoet"),icon:()=>(0,E.jsx)("div",{style:{width:"100%",height:"100%",scale:"1.4"},children:Ir}),edit:()=>(0,E.jsx)("div",{})},Zr={key:"mailpoet:wp-user-registered",group:"triggers",title:(0,w.__)("WordPress user registered","mailpoet"),foreground:"#2271b1",background:"#f0f6fc",description:(0,w.__)("Starts the automation when a new user registered in WordPress. Use trigger filters to filter by a specific user role.","mailpoet"),subtitle:()=>(0,w.__)("Trigger","mailpoet"),icon:()=>(0,E.jsx)("div",{style:{width:"100%",height:"100%",scale:"1.12"},children:h}),edit:()=>(0,E.jsx)("div",{})};function Ar(){const{isFullscreenActive:e,isInserterOpened:t,isSidebarOpened:n,showIconLabels:o,workflow:i}=(0,p.Z)((e=>({isFullscreenActive:e(P.storeName).isFeatureActive("fullscreenMode"),isInserterOpened:e(P.storeName).isInserterSidebarOpened(),isSidebarOpened:e(P.storeName).isSidebarOpened(),showIconLabels:e(P.storeName).isFeatureActive("showIconLabels"),workflow:e(P.storeName).getWorkflowData()})),[]),r=s()("interface-interface-skeleton",{"is-sidebar-opened":n,"show-icon-labels":o});return"trash"===i.status?(window.location.href=(0,_.f)(we.x.urls.automationListing,{[xe.E.workflowHadBeenDeleted]:i.id}),null):(0,E.jsx)(v.vn,{children:(0,E.jsxs)(l.zt,{children:[(0,E.jsx)(f.x4,{isActive:e}),(0,E.jsx)(de,{}),(0,E.jsx)(Pe,{}),(0,E.jsx)(f.v4,{className:r,drawer:e&&(0,E.jsx)("div",{className:"edit-site-navigation-toggle",children:(0,E.jsx)(c.Z,{className:"edit-site-navigation-toggle__button has-icon",href:"admin.php?page=mailpoet-automation",children:(0,E.jsx)(u.Z,{size:36,icon:h})})}),header:(0,E.jsx)(z,{showInserterToggle:!1}),content:(0,E.jsx)(ar,{}),sidebar:(0,E.jsx)(f.Vi.Slot,{scope:P.storeName}),secondarySidebar:null}),(0,E.jsx)(d.Z.Slot,{})]})})}window.addEventListener("DOMContentLoaded",(()=>{(0,P.createStore)();const e=document.getElementById("mailpoet_automation_editor");e&&((0,lr.qN)(),(0,P.registerStepType)(hr),(0,P.registerStepType)(Cr),(0,P.registerStepType)(Zr),(0,P.registerStepType)(Br),a.render((0,E.jsx)(Ar,{}),e))}))},65311:function(e){e.exports=jQuery}},function(e){e.O(0,[351],(function(){return 57647,e(e.s=57647)})),e.O()}]);